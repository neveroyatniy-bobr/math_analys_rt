# Билет 14 - Матрицы
## 14.1. Алгебраические операции с матрицами

> [!definition] Матрица  
> Матрицей размеров $m \times n$ называется совокупность $mn$ чисел,  
> расположенных в виде таблицы из $m$ строк и $n$ столбцов:
> $$
> A =
> \begin{pmatrix}
> a_{11} & a_{12} & \dots & a_{1n} \\
> a_{21} & a_{22} & \dots & a_{2n} \\
> \vdots & \vdots & \ddots & \vdots \\
> a_{m1} & a_{m2} & \dots & a_{mn}
> \end{pmatrix},
> \qquad A_{m \times n}.
> $$

---

### 1) Сложение матриц и умножение на число

Пусть $A$ и $B$ — матрицы размеров $m \times n$.

> [!definition] Сумма матриц  
> Матрица $C$, определяемая по формуле  
> $$
> c_{ij} = a_{ij} + b_{ij},
> \quad i = 1,\dots,m,\ j = 1,\dots,n,
> $$
> называется суммой матриц $A$ и $B$ и обозначается
> $$
> C = A + B.
> $$

> [!definition] Произведение матрицы на число  
> Матрица $C$, элементы которой равны произведениям элементов матрицы $A$  
> на число $d$, называется произведением матрицы $A$ на число $d$  
> и обозначается
> $$
> C = dA.
> $$

> [!theorem] Свойства  
> Для матриц $A,B,C$ и чисел $d,\beta$ выполняются:
> 1. $A + B = B + A$  
> 2. $(A + B) + C = A + (B + C)$  
> 3. $d(A + B) = dA + dB$  
> 4. $(d + \beta)A = dA + \beta A$  
> 5. $d(\beta A) = (d\beta)A$  
> 6. $A + 0 = A$, где $0$ — нулевая матрица $m \times n$  
> 7. $A + (-A) = 0$, где $-A$ — противоположная матрица

---

### 2) Умножение матриц

> [!definition] Произведение матриц  
> Матрица $C$, элементы которой вычисляются по формуле
> $$
> c_{ij} = \sum_{k=1}^{n} a_{ik} b_{kj},
> $$
> называется произведением матриц $A$ и $B$ и обозначается $AB$.

Пример:
$$
\begin{pmatrix}
a & b & c & d
\end{pmatrix}
\cdot
\begin{pmatrix}
k \\ l \\ m \\ n
\end{pmatrix}
=
\begin{pmatrix}
ak + bl + cm + dn
\end{pmatrix}.
$$

---

### Свойства умножения матриц

> [!important]
> 1. $AB \ne BA$ (в общем случае)  
> 2. Если определены $AB$ и $(AB)C$, то определены $BC$ и $A(BC)$, и
> $$
> (AB)C = A(BC)
> $$
> 3. Если имеет смысл $A(B+C)$, то
> $$
> A(B+C) = AB + AC
> $$
> 4. Если имеет смысл $(B+C)A$, то
> $$
> (B+C)A = BA + CA
> $$
> 5. Если определено $AB$, то определено $B^TA^T$, и
> $$
> (AB)^T = B^TA^T
> $$

---

### Развернутая проверка дистрибутивности

Пусть
- $A$ — матрица $p \times m$,
- $B, C$ — матрицы $m \times n$.

Тогда
$$
A(B+C) =
\left(
\sum_{k=1}^m a_{ik}(b_{kj} + c_{kj})
\right)
=
\sum_{k=1}^m a_{ik}b_{kj}
+
\sum_{k=1}^m a_{ik}c_{kj}.
$$

Эти суммы равны элементам матриц $AB$ и $AC$, стоящим на местах $i,j$.

---

### Транспонирование и произведение

Пусть:
- $A$ — матрица $m \times n$,
- $B$ — матрица $n \times p$.

Тогда:
- элемент $AB$ в позиции $(i,j)$ равен
  $$
  \sum_{k=1}^n a_{ik}b_{kj},
  $$
- элемент $B^TA^T$ в позиции $(j,i)$ равен
  $$
  \sum_{k=1}^n b_{kj}a_{ik}.
  $$

Следовательно,
$$
(AB)^T = B^TA^T.
$$
## 14.2. Элементарные преобразования матриц

> [!definition] Элементарные преобразования строк матрицы  
> Элементарными преобразованиями строк матрицы называются следующие преобразования:
> 1. умножение строки на число, отличное от нуля;
> 2. прибавление к одной строке другой строки, умноженной на число;
> 3. перестановка двух строк.

Более сложные преобразования можно относить к элементарным.

Аналогично со столбцами.

> [!important]
> Элементарные преобразования обратимы.

---

### Связь с умножением на элементарные матрицы

Каждое элементарное преобразование строк матрицы $A$ равносильно умножению $A$ слева на некоторую матрицу $S$.

При этом матрица $S$ не зависит от $A$, а зависит только от преобразования.

Примеры:

1) Умножение первой строки на $\lambda$:
$$
\begin{pmatrix}
\lambda & 0 \\
0 & 1
\end{pmatrix}
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
=
\begin{pmatrix}
\lambda a & \lambda b \\
c & d
\end{pmatrix}
$$

2) Прибавление первой строки ко второй:
$$
\begin{pmatrix}
1 & 0 \\
1 & 1
\end{pmatrix}
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
=
\begin{pmatrix}
a & b \\
a + c & b + d
\end{pmatrix}
$$

> [!definition] Элементарная матрица  
> Матрица, умножение на которую осуществляет элементарное преобразование,
> называется элементарной матрицей.

---

### Линейная зависимость системы матриц

> [!definition] Линейная зависимость  
> Система матриц $A_1,\dots,A_k$ называется линейно зависимой,
> если нулевая матрица представляется по ней однозначно, т.е.
> $$
> d_1A_1 + \dots + d_kA_k = 0 \Rightarrow d_1 = \dots = d_k = 0.
> $$

В противном случае система называется линейно зависимой, т.е.  
существуют числа $d_1,\dots,d_k$, не все равные нулю, такие что
$$
d_1A_1 + \dots + d_kA_k = 0.
$$

---

### Вырожденная матрица

> [!definition] Вырожденная матрица  
> Квадратная матрица называется вырожденной, если её строки линейно зависимы.

---

### Свойства элементарных преобразований

> [!theorem]  
> Элементарные преобразования строк переводят линейно зависимую систему строк
> в линейно зависимую, а линейно независимую — в линейно независимую.

**Доказательство.**

Пусть строки $\vec a_1,\vec a_2,\dots,\vec a_n$ линейно независимы.

Рассмотрим прибавление первой строки ко второй:
$$
\vec a_2 \mapsto \vec a_2 + \vec a_1.
$$

Если
$$
d_1\vec a_1 + d_2(\vec a_2 + \vec a_1) + \dots + d_n\vec a_n = 0,
$$
то
$$
(d_1 + d_2)\vec a_1 + d_2\vec a_2 + \dots + d_n\vec a_n = 0.
$$

Из линейной независимости следует:
$$
d_1 + d_2 = 0,\quad d_2 = 0,\dots,d_n = 0,
$$
откуда
$$
d_1 = 0.
$$

Аналогично для умножения строки на число $\lambda \ne 0$ и перестановки строк.

---

### Следствие

> [!important]
> Невырожденная матрица при элементарных преобразованиях
> остаётся невырожденной, а вырожденная — вырожденной.

---

### Сохранение линейных зависимостей между столбцами

> [!theorem]
> Элементарные преобразования строк сохраняют линейные зависимости между столбцами.
> Элементарные преобразования столбцов сохраняют линейные зависимости между строками.

Пусть
$$
A = (\vec a_1,\dots,\vec a_n),
$$
и выполняется
$$
d_1\vec a_1 + \dots + d_n\vec a_n = 0.
$$

После элементарного преобразования строк:
$$
SA = (S\vec a_1,\dots,S\vec a_n),
$$
и
$$
d_1(S\vec a_1) + \dots + d_n(S\vec a_n) = S \cdot 0 = 0.
$$

---

### Приведение невырожденной матрицы к единичной

> [!theorem]
> Каждая невырожденная квадратная матрица с помощью элементарных преобразований строк
> может быть приведена к единичной матрице.

**Доказательство (алгоритм).**

Пусть $A$ — невырожденная матрица порядка $n$.

В первой строке существует элемент $a_{1s} \ne 0$ (иначе $A$ вырождена).

Переставим столбцы так, чтобы $a_{11} \ne 0$.

Разделим первую строку на $a_{11}$.

С помощью элементарных преобразований занулим элементы первого столбца,
кроме первого.

Повторяя процесс для подматрицы порядка $n-1$, получим единичную матрицу $E$.

---

## 14.3. Обратная матрица

> [!definition] Обратная матрица  
> Матрица $X$ называется **обратной** для матрицы $A$, если
> $$
> XA = AX = E,
> $$
> где $E$ — единичная матрица.

Заметим, что матрицы могут быть обратимы **только в том случае**, если они квадратные
и одного порядка.

---

> [!theorem] Пр1  
> Если у матрицы $A$ существует обратная матрица, то она единственна.

**Доказательство.**

Пусть $X_1$ и $X_2$ — обратные матрицы для $A$, т.е.
$$
X_1A = AX_1 = E,\qquad X_2A = AX_2 = E.
$$

Тогда
$$
X_1 = X_1(AX_2) = (X_1A)X_2 = EX_2 = X_2.
$$
■

>[!important] Следствие
>В силу обратимости
>$$
 T_m\dots T_1A = E
>$$



---

> [!theorem] Пр2  
> Матрица имеет обратную тогда и только тогда, когда она невырожденная.


**Доказательство.**

**$(\Rightarrow)$**  
Если матрица $A$ имеет обратную, то
$$
AX = E.
$$
Следовательно, $A$ — произведение элементарных матриц, а значит, невырожденная.

**$(\Leftarrow)$**  
Если $A$ — невырожденная матрица, то по теореме 14.2
существуют элементарные матрицы $T_1,\dots,T_m$ такие, что
$$
T_m\dots T_1A = E.
$$
Обозначим
$$
X = T_m\dots T_1.
$$
Тогда
$$
XA = E.
$$

Покажем, что
$$
AX = E.
$$
Так как каждая элементарная матрица обратима, то $X$ обратима,
следовательно, существует $Y$ такое, что
$$
YX = E.
$$
Тогда
$$
A = Y(XA) = YE = Y,
$$
и
$$
AX = E.
$$

Таким образом, $X$ — обратная матрица к $A$. ■

---

> [!important]
> Вырожденная матрица не имеет обратной.

**Доказательство.**

Пусть $A$ — вырожденная матрица. Тогда существуют числа
$\lambda_1,\dots,\lambda_n$, не все равные нулю, такие что
$$
\lambda_1\vec a_1 + \dots + \lambda_n\vec a_n = 0,
$$
где $\vec a_i$ — строки матрицы $A$.

Обозначим строку
$$
\vec v = (\lambda_1,\dots,\lambda_n).
$$

Тогда
$$
\vec v A = 0.
$$

Если бы существовала обратная матрица $X$, то
$$
\vec v = \vec v(AX) = (\vec vA)X = 0,
$$
что противоречит выбору $\vec v$. ■

---

### Обозначение обратной матрицы

Обратную матрицу к $A$ обозначают через $A^{-1}$.

---

### Основные свойства обратной матрицы

> [!important]
> 1. $(A^{-1})^{-1} = A$
> 2. $(AB)^{-1} = B^{-1}A^{-1}$
> 3. $(A^T)^{-1} = (A^{-1})^T$

**Доказательства.**

1.
$$
A^{-1}A = E \Rightarrow (A^{-1})^{-1} = A.
$$

2.
$$
(AB)(B^{-1}A^{-1}) = A(BB^{-1})A^{-1} = AEA^{-1} = E.
$$

3.
Из равенства
$$
A^TA^{-T} = E
$$
следует
$$
(A^T)^{-1} = (A^{-1})^T.
$$

---

> [!theorem] Теорема  
> Пусть $A$ — невырожденная матрица порядка $n$.
> Тогда любой столбец вектора $\vec b$ можно разложить по столбцам матрицы $A$,
> причём коэффициенты разложения определяются однозначно.

**Доказательство.**

Так как $A$ невырожденная, то существует $A^{-1}$.

Пусть
$$
\vec b = A\vec x.
$$

Тогда
$$
\vec x = A^{-1}\vec b.
$$

Следовательно, коэффициенты разложения $\vec x$ определяются однозначно. ■
